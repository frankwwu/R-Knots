ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
#ggExtra::ggMarginal(p)
#ggExtra::ggMarginal(p, type = "density", size = 2, col = "darkorange4", fill = "gold")
#ggplot(data=a, aes(x = Month)) + geom_bar() + geom_text(stat='bin',aes(label=..count..))
p <- ggplot(a, aes(x = Month))
p + geom_histogram(aes(fill=Fatalities),
binwidth = .1,
col="black",
size=.1)
#ggplot(data=a, aes(x = Month)) + geom_bar() + geom_text(stat='bin',aes(label=..count..))
p <- ggplot(a, aes(x = Month))
p + geom_bar(aes(fill=Fatalities), width = 0.5)
p <- ggplot(a, aes(x = Month, y = Fatalities, colour = Fatalities)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
p <- ggplot(a, aes(x = Month, y = Injured, colour = Injured)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
p <- ggplot(a, aes(x = Month, y = Total.victims, colour = Total.victims)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
#ggExtra::ggMarginal(p)
#ggExtra::ggMarginal(p, type = "density", size = 2, col = "darkorange4", fill = "gold")
#ggplot(data=a, aes(x = Month)) + geom_bar() + geom_text(stat='bin',aes(label=..count..))
p <- ggplot(a, aes(x = Month))
p + geom_bar(aes(fill=Fatalities), width = 0.5) +
labs(title="Fatalities")
p <- ggplot(a, aes(x = Month, y = Fatalities, colour = Fatalities)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
p <- ggplot(a, aes(x = Month, y = Injured, colour = Injured)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
p <- ggplot(a, aes(x = Month, y = Total.victims, colour = Total.victims)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
#ggExtra::ggMarginal(p)
#ggExtra::ggMarginal(p, type = "density", size = 2, col = "darkorange4", fill = "gold")
#ggplot(data=a, aes(x = Month)) + geom_bar() + geom_text(stat='bin',aes(label=..count..))
p <- ggplot(a, aes(x = Month))
p + geom_bar(aes(fill=Fatalities), width = 0.5) +
labs(title="Fatalities")
p + geom_bar(aes(fill=Injured), width = 0.5) +
labs(title="Fatalities")
p <- ggplot(a, aes(x = Month, y = Fatalities, colour = Fatalities)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
p <- ggplot(a, aes(x = Month, y = Injured, colour = Injured)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
p <- ggplot(a, aes(x = Month, y = Total.victims, colour = Total.victims)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
#ggExtra::ggMarginal(p)
#ggExtra::ggMarginal(p, type = "density", size = 2, col = "darkorange4", fill = "gold")
#ggplot(data=a, aes(x = Month)) + geom_bar() + geom_text(stat='bin',aes(label=..count..))
p <- ggplot(a, aes(x = Month))
p + geom_bar(aes(fill=Fatalities, colour = Fatalities), width = 0.5) +
labs(title="Fatalities")
p + geom_bar(aes(fill=Injured, colour = Injured), width = 0.5) +
labs(title="Fatalities")
p <- ggplot(a, aes(x = Month, y = Fatalities, colour = Fatalities)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
p <- ggplot(a, aes(x = Month, y = Injured, colour = Injured)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
p <- ggplot(a, aes(x = Month, y = Total.victims, colour = Total.victims)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
#ggExtra::ggMarginal(p)
#ggExtra::ggMarginal(p, type = "density", size = 2, col = "darkorange4", fill = "gold")
#ggplot(data=a, aes(x = Month)) + geom_bar() + geom_text(stat='bin',aes(label=..count..))
p <- ggplot(a, aes(x = Month))
p + geom_bar(aes(fill=Fatalities, colour = 'r'), width = 0.5) +
labs(title="Fatalities")
p + geom_bar(aes(fill=Injured, colour = 'b'), width = 0.5) +
labs(title="Injured")
p <- ggplot(a, aes(x = Month, y = Fatalities, colour = Fatalities)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
p <- ggplot(a, aes(x = Month, y = Injured, colour = Injured)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
p <- ggplot(a, aes(x = Month, y = Total.victims, colour = Total.victims)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
#ggExtra::ggMarginal(p)
#ggExtra::ggMarginal(p, type = "density", size = 2, col = "darkorange4", fill = "gold")
#ggplot(data=a, aes(x = Month)) + geom_bar() + geom_text(stat='bin',aes(label=..count..))
p <- ggplot(a, aes(x = Month))
p + geom_bar(aes(fill=Fatalities, fill = 'r'), width = 0.5) +
labs(title="Fatalities")
p + geom_bar(aes(fill=Injured, fill = 'b'), width = 0.5) +
labs(title="Injured")
p <- ggplot(a, aes(x = Month, y = Fatalities, colour = Fatalities)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
p <- ggplot(a, aes(x = Month, y = Injured, colour = Injured)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
p <- ggplot(a, aes(x = Month, y = Total.victims, colour = Total.victims)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
#ggExtra::ggMarginal(p)
#ggExtra::ggMarginal(p, type = "density", size = 2, col = "darkorange4", fill = "gold")
#ggplot(data=a, aes(x = Month)) + geom_bar() + geom_text(stat='bin',aes(label=..count..))
#p <- ggplot(a, aes(x = Month))
ggplot(a, aes(x = Month)) + geom_bar(aes(fill=Fatalities, fill = 'r'), width = 0.5) +
labs(title="Fatalities")
ggplot(a, aes(x = Month)) + geom_bar(aes(fill=Injured, fill = 'b'), width = 0.5) +
labs(title="Injured")
p <- ggplot(a, aes(x = Month, y = Fatalities, colour = Fatalities)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
p <- ggplot(a, aes(x = Month, y = Injured, colour = Injured)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
p <- ggplot(a, aes(x = Month, y = Total.victims, colour = Total.victims)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
#ggExtra::ggMarginal(p)
#ggExtra::ggMarginal(p, type = "density", size = 2, col = "darkorange4", fill = "gold")
#ggplot(data=a, aes(x = Month)) + geom_bar() + geom_text(stat='bin',aes(label=..count..))
#p <- ggplot(a, aes(x = Month))
ggplot(a, aes(x = Month, y = Fatalities)) + geom_bar(aes(fill=Fatalities, fill = 'r'), width = 0.5) +
labs(title="Fatalities")
#ggplot(data=a, aes(x = Month)) + geom_bar() + geom_text(stat='bin',aes(label=..count..))
#p <- ggplot(a, aes(x = Month))
ggplot(a, aes(x = Month)) + geom_bar(aes(fill=Fatalities), width = 0.5) +
labs(title="Fatalities")
ggplot(a, aes(x = Month)) + geom_bar(aes(fill=Injured), width = 0.5) +
labs(title="Injured")
p <- ggplot(a, aes(x = Month, y = Fatalities, colour = Fatalities)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
p <- ggplot(a, aes(x = Month, y = Injured, colour = Injured)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
p <- ggplot(a, aes(x = Month, y = Total.victims, colour = Total.victims)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
#ggExtra::ggMarginal(p)
#ggExtra::ggMarginal(p, type = "density", size = 2, col = "darkorange4", fill = "gold")
#ggplot(data=a, aes(x = Month)) + geom_bar() + geom_text(stat='bin',aes(label=..count..))
#p <- ggplot(a, aes(x = Month))
ggplot(a, aes(x = Month)) + geom_bar(aes(fill=Fatalities), width = 0.5) +
labs(title="Fatalities")
ggplot(a, aes(x = Month)) + geom_bar(aes(fill=Injured), width = 0.5) +
labs(title="Injured")
ggplot(a, aes(x = Month)) + geom_bar(aes(fill=Total.victims), width = 0.5) +
labs(title="Total.victims")
p <- ggplot(a, aes(x = Month, y = Fatalities, colour = Fatalities)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
p <- ggplot(a, aes(x = Month, y = Injured, colour = Injured)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
p <- ggplot(a, aes(x = Month, y = Total.victims, colour = Total.victims)) +
geom_violin() +
ggtitle("US Mass Shootings") +
theme(legend.position="none")
p
#ggExtra::ggMarginal(p)
#ggExtra::ggMarginal(p, type = "density", size = 2, col = "darkorange4", fill = "gold")
url <- getURL('https://raw.githubusercontent.com/frankwwu/R-Knots/master/US%20Mass%20Shootings/Mass%20Shootings%20Dataset%20Ver 2.csv')
shoot <- read.csv(text = url)
url <- getURL('https://raw.githubusercontent.com/frankwwu/R-Knots/master/US%20Mass%20Shootings/Mass%20Shootings%20Dataset%20Ver%202.csv')
shoot <- read.csv(text = url)
library(RCurl)
install.packages("RCurl")
library(RCurl)
url <- getURL('https://raw.githubusercontent.com/frankwwu/R-Knots/master/US%20Mass%20Shootings/Mass%20Shootings%20Dataset%20Ver%202.csv')
shoot <- read.csv(text = url)
head(shoot)
library(RCurl)
library(lubridate)
library(gridExtra)
library(plotly)
library(ggplot2)
url <- getURL('https://raw.githubusercontent.com/frankwwu/R-Knots/master/US%20Mass%20Shootings/Mass%20Shootings%20Dataset%20Ver%202.csv')
shoot <- read.csv(text = url)
shoot$Month <- factor(month(as.Date(shoot$Date, format = "%m/%d/%Y")))
ggplot(shoot, aes(x = Month)) + geom_bar(aes(fill=Fatalities), width = 0.5) +
labs(title="Fatalities")
ggplot(shoot, aes(x = Month)) + geom_bar(aes(fill=Injured), width = 0.5) +
labs(title="Injured")
ggplot(shoot, aes(x = Month)) + geom_bar(aes(fill=Total.victims), width = 0.5) +
labs(title="Total.victims")
ggplot(shoot, aes(x = Month)) + geom_bar(aes(fill=Fatalities), width = 0.5) +
labs(title="Fatalities")
ggplot(shoot, aes(x = Month)) + geom_bar(aes(fill=Injured), width = 0.5) +
labs(title="Injured")
ggplot(shoot, aes(x = Month)) + geom_bar(aes(fill=Total.victims), width = 0.5) +
labs(title="Total.victims")
ggplot(shoot, aes(x = Month)) + geom_bar(aes(fill=Fatalities), width = 0.5) +
labs(title="Number of Shooting per Month")
ggplot(shoot, aes(x = Month, fill=Month)) + geom_bar(aes(fill=Fatalities), width = 0.5) +
labs(title="Number of Shooting per Month")
ggplot(shoot, aes(x = Month, fill=Month)) + geom_bar(aes(fill=Month), width = 0.5) +
labs(title="Number of Shooting per Month")
ggplot(shoot, aes(x = Month)) + geom_bar(aes(fill=Month), width = 0.5) +
labs(title="Number of Shooting per Month")
ggplot(shoot, aes(x = Date)) + geom_bar(aes(fill=Date), width = 0.5) +
labs(title="Number of Shooting per Year")
shoot$Month <- factor(month(as.Date(shoot$Date, format = "%m/%d/%Y")))
shoot$Year <- factor(year(as.Date(shoot$Date, format = "%m/%d/%Y")))
ggplot(shoot, aes(x = Year)) + geom_bar(aes(fill=Year), width = 0.5) +
labs(title="Number of Shooting per Year")
ggplot(shoot, aes(x = Year)) + geom_bar(aes(fill = Year), width = 0.5) +
labs(title="Number of Shooting per Year") +
theme(legend.position="none", axis.text.x=element_text(angle=90))
library(RCurl)
library(lubridate)
library(gridExtra)
library(plotly)
library(ggplot2)
url <- getURL('https://raw.githubusercontent.com/frankwwu/R-Knots/master/US%20Mass%20Shootings/Mass%20Shootings%20Dataset%20Ver%202.csv')
shoot <- read.csv(text = url)
shoot$Month <- factor(month(as.Date(shoot$Date, format = "%m/%d/%Y")))
shoot$Year <- factor(year(as.Date(shoot$Date, format = "%m/%d/%Y")))
ggplot(shoot, aes(x = Year)) + geom_bar(aes(fill = Year), width = 0.5) +
labs(title="Number of Shootings per Year") +
theme(legend.position="none", axis.text.x=element_text(angle=90))
ggplot(shoot, aes(x = Month)) + geom_bar(aes(fill=Month), width = 0.5) +
labs(title="Number of Shootings per Month")
ggplot(shoot, aes(x = Month)) + geom_bar(aes(fill=Total.victims), width = 0.5) +
labs(title="Total.victims")
ggplot(shoot[shoot$"Mental Health Issues"="Yes",], aes(x = Year)) + geom_bar(aes(fill = Year), width = 0.5) +
ggplot(shoot[shoot$'Mental Health Issues'='Yes',], aes(x = Year)) + geom_bar(aes(fill = Year), width = 0.5) +
shoot[shoot$'Mental Health Issues'='Yes',]
shoot[shoot$'Mental Health Issues'=='Yes',]
ggplot(shoot[shoot$'Mental Health Issues'=='Yes',], aes(x = Year)) + geom_bar(aes(fill = Year), width = 0.5) +
labs(title="Number of Shootings per Year") +
theme(legend.position="none", axis.text.x=element_text(angle=90))
library(RCurl)
library(lubridate)
library(gridExtra)
library(plotly)
library(ggplot2)
library(dplyr)
install.packages("dplyr")
library(RCurl)
library(lubridate)
library(gridExtra)
library(plotly)
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
library(RCurl)
library(lubridate)
library(gridExtra)
library(plotly)
library(RCurl)
library(lubridate)
library(gridExtra)
#library(plotly)
library(ggplot2)
library(dplyr)
library(RCurl)
library(lubridate)
library(gridExtra)
#library(plotly)
library(ggplot2)
#library(dplyr)
shoot[shoot$'Mental Health Issues'<'Yes',]
s<-shoot[shoot$'Mental Health Issues'<'Yes',]
head(s)
s<-shoot[shoot$'Mental Health Issues'<'Yes',]
s
head(s)
shoot[shoot$'Mental Health Issues'<'Yes',]
shoot[shoot$'Mental Health Issues'=='Yes',]
shoot[$'Mental Health Issues'=='Yes',]
shoot$'Mental Health Issues'
shoot$"Mental Health Issues"
names(shoot) <- sub(" ", ".", names(shoot))
shoot$Month <- factor(month(as.Date(shoot$Date, format = "%m/%d/%Y")))
shoot$Year <- factor(year(as.Date(shoot$Date, format = "%m/%d/%Y")))
shoot[shoot$'Mental.Health.Issues'=='Yes',]
ggplot(shoot[shoot$Mental.Health.Issues=='Yes',], aes(x = Year)) + geom_bar(aes(fill = Year), width = 0.5) +
labs(title="Number of Shootings per Year") +
theme(legend.position="none", axis.text.x=element_text(angle=90))
ggplot(shoot[shoot$Mental.Health.Issues=='Yes',], aes(x = Year)) + geom_bar(aes(fill = Year), width = 0.5) +
labs(title="Number of Shootings with Mental Health Issues per Year") +
theme(legend.position="none", axis.text.x=element_text(angle=90))
library(RCurl)
library(lubridate)
library(gridExtra)
#library(plotly)
library(ggplot2)
#library(dplyr)
url <- getURL('https://raw.githubusercontent.com/frankwwu/R-Knots/master/US%20Mass%20Shootings/Mass%20Shootings%20Dataset%20Ver%202.csv')
shoot <- read.csv(text = url)
names(shoot) <- sub(" ", ".", names(shoot))
shoot$Month <- factor(month(as.Date(shoot$Date, format = "%m/%d/%Y")))
shoot$Year <- factor(year(as.Date(shoot$Date, format = "%m/%d/%Y")))
ggplot(shoot, aes(x = Year)) + geom_bar(aes(fill = Year), width = 0.5) +
labs(title="Number of Shootings per Year") +
theme(legend.position="none", axis.text.x=element_text(angle=90))
ggplot(shoot, aes(x = Month)) + geom_bar(aes(fill=Month), width = 0.5) +
labs(title="Number of Shootings per Month")
ggplot(shoot[shoot$Mental.Health.Issues=='Yes',], aes(x = Year)) + geom_bar(aes(fill = Year), width = 0.5) +
labs(title="Number of Shootings with Mental Health Issues per Year") +
theme(legend.position="none", axis.text.x=element_text(angle=90))
library(RCurl)
library(lubridate)
library(gridExtra)
#library(plotly)
library(ggplot2)
#library(dplyr)
url <- getURL('https://raw.githubusercontent.com/frankwwu/R-Knots/master/US%20Mass%20Shootings/Mass%20Shootings%20Dataset%20Ver%202.csv')
shoot <- read.csv(text = url)
names(shoot) <- sub(" ", ".", names(shoot))
shoot$Month <- factor(month(as.Date(shoot$Date, format = "%m/%d/%Y")))
shoot$Year <- factor(year(as.Date(shoot$Date, format = "%m/%d/%Y")))
ggplot(shoot, aes(x = Year)) + geom_bar(aes(fill = Year), width = 0.5) +
labs(title="Number of Shootings per Year") +
theme(legend.position="none", axis.text.x=element_text(angle=90))
ggplot(shoot[shoot$Mental.Health.Issues=='Yes',], aes(x = Year)) + geom_bar(aes(fill = Year), width = 0.5) +
labs(title="Number of Shootings with Mental Health Issues per Year") +
theme(legend.position="none", axis.text.x=element_text(angle=90))
ggplot(shoot, aes(x = Month)) + geom_bar(aes(fill=Month), width = 0.5) +
labs(title="Number of Shootings per Month")
library(RCurl)
library(lubridate)
library(gridExtra)
#library(plotly)
library(ggplot2)
#library(dplyr)
url <- getURL('https://raw.githubusercontent.com/frankwwu/R-Knots/master/US%20Mass%20Shootings/Mass%20Shootings%20Dataset%20Ver%202.csv')
shoot <- read.csv(text = url)
names(shoot) <- sub(" ", ".", names(shoot))
shoot$Month <- factor(month(as.Date(shoot$Date, format = "%m/%d/%Y")))
shoot$Year <- factor(year(as.Date(shoot$Date, format = "%m/%d/%Y")))
ggplot(shoot, aes(x = Year)) + geom_bar(aes(fill = Year), width = 0.5) +
labs(title="Number of Shootings per Year") +
theme(legend.position="none", axis.text.x=element_text(angle=90))
ggplot(shoot[shoot$Mental.Health.Issues=='Yes',], aes(x = Year)) + geom_bar(aes(fill = Year), width = 0.5) +
labs(title="Number of Shootings with Mental Health Issues per Year") +
theme(legend.position="none", axis.text.x=element_text(angle=90))
ggplot(shoot, aes(x = Month)) + geom_bar(aes(fill=Month), width = 0.5) +
labs(title="Number of Shootings per Month")
library(RCurl)
library(lubridate)
library(gridExtra)
library(ggplot2)
library(dplyr)
library(formattable)
library(scales)
url <- getURL('https://raw.githubusercontent.com/frankwwu/R-Knots/master/US%20Mass%20Shootings/Mass%20Shootings%20Dataset%20Ver%202.csv')
shoot <- read.csv(text = url)
shoot %>% mutate_if(is.factor, as.character) -> shoot
names(shoot) <- sub(" ", ".", names(shoot))
shoot$Month <- factor(month(as.Date(shoot$Date, format = "%m/%d/%Y")))
shoot$Year <- factor(year(as.Date(shoot$Date, format = "%m/%d/%Y")))
str(shoot)
shoot[shoot$Mental.Health.Issues=="Unclear",]$Mental.Health.Issues<-"Unknown"
shoot[shoot$Mental.Health.Issues=="unknown",]$Mental.Health.Issues<-"Unknown"
ggplot(shoot, aes(x = Year)) +
geom_bar(aes(fill = Year), width = 0.5) +
labs(title="Number of Shootings per Year") +
theme(legend.position="none", axis.text.x=element_text(angle=90))
ggplot(shoot, aes(x = Year), groupName='Mental.Health.Issues') +
geom_bar(aes(fill = Mental.Health.Issues), width = 0.5) +
labs(title="Number of Shootings with Mental Health Issues per Year") +
theme(axis.text.x=element_text(angle=90)) +
scale_fill_manual (values=c("#0275D2", "#00E699", "#FB008A")) +
theme(legend.position="bottom")
ggplot(shoot, aes(x = Month), groupName='Mental.Health.Issues') +
geom_bar(aes(fill = Mental.Health.Issues), width = 0.5) +
labs(title="Number of Shootings with Mental Health Issues per Month") +
scale_fill_manual (values=c("#0275D2", "#00E699", "#FB008A")) +
theme(legend.position="bottom")
top10Fatalities <- shoot %>% filter(rank(desc(Fatalities)) <= 10)
top10Fatalities <- top10Fatalities[order(-top10Fatalities$Fatalities),]
formattable(top10Fatalities[ c("Location", "Date", "Fatalities", "Injured", "Total.victims", "Mental.Health.Issues")], list(
Fatalities = color_bar("coral"),
Injured = color_bar("springgreen"),
Total.victims = color_bar("violet"),
Mental.Health.Issues = formatter("span", style = x ~ ifelse(x == "Yes", style(color = "red", font.weight = "bold"), NA))))
top10Total.victims <- shoot %>% filter(rank(desc(Total.victims)) <= 10)
top10Total.victims <- top10Total.victims[order(-top10Total.victims$Total.victim),]
formattable(top10Total.victims[ c("Location", "Date", "Fatalities", "Injured", "Total.victims", "Mental.Health.Issues")], list(
Fatalities = color_bar("coral"),
Injured = color_bar("springgreen"),
Total.victims = color_bar("violet"),
Mental.Health.Issues = formatter("span", style = x ~ ifelse(x == "Yes", style(color = "red", font.weight = "bold"), NA))))
library(RCurl)
library(lubridate)
library(gridExtra)
library(ggplot2)
library(dplyr)
library(formattable)
library(scales)
url <- getURL('https://raw.githubusercontent.com/frankwwu/R-Knots/master/US%20Mass%20Shootings/Mass%20Shootings%20Dataset%20Ver%205.csv')
shoot <- read.csv(text = url)
shoot %>% mutate_if(is.factor, as.character) -> shoot
names(shoot) <- sub(" ", ".", names(shoot))
shoot$Month <- factor(month(as.Date(shoot$Date, format = "%m/%d/%Y")))
shoot$Year <- factor(year(as.Date(shoot$Date, format = "%m/%d/%Y")))
str(shoot)
shoot[shoot$Mental.Health.Issues=="Unclear",]$Mental.Health.Issues<-"Unknown"
shoot[shoot$Mental.Health.Issues=="unknown",]$Mental.Health.Issues<-"Unknown"
shoot[shoot$Race=="",]$Race<-"Unknown"
shoot[shoot$Race=="White American or European American",]$Race<-"White"
shoot[shoot$Race=="White American or European American/Some other Race",]$Race<-"White"
shoot[shoot$Race=="white",]$Race<-"White"
shoot[shoot$Race=="Black American or African American/Unknown",]$Race<-"Black"
shoot[shoot$Race=="Black American or African American",]$Race<-"Black"
shoot[shoot$Race=="black",]$Race<-"Black"
shoot[shoot$Race=="Asian American",]$Race<-"Asian"
shoot[shoot$Race=="Asian American/Some other race",]$Race<-"Asian"
shoot[shoot$Race=="Native American or Alaska Native",]$Race<-"Native"
shoot[shoot$Race=="Some other race",]$Race<-"Other"
ggplot(shoot, aes(x = Year)) +
geom_bar(aes(fill = Year), width = 0.5) +
labs(title="Number of Shootings per Year") +
theme(legend.position="none", axis.text.x=element_text(angle=90))
ggplot(shoot, aes(x = Year), groupName='Mental.Health.Issues') +
geom_bar(aes(fill = Mental.Health.Issues), width = 0.5) +
labs(title="Number of Shootings with Mental Health Issues per Year") +
theme(axis.text.x=element_text(angle=90)) +
scale_fill_manual (values=c("#0275D2", "#00E699", "#FB008A")) +
theme(legend.position="bottom")
ggplot(shoot, aes(x = Month), groupName='Mental.Health.Issues') +
geom_bar(aes(fill = Mental.Health.Issues), width = 0.5) +
labs(title="Number of Shootings with Mental Health Issues per Month") +
scale_fill_manual (values=c("#0275D2", "#00E699", "#FB008A")) +
theme(legend.position="bottom")
ggplot(shoot, aes(x = Month, y = Total.victims, fill=Mental.Health.Issues)) +
geom_violin() +
scale_y_continuous(trans='log10') +
facet_grid(. ~ Mental.Health.Issues) +
labs(title="Density of Shootings with Mental Health Issues per Month") +
scale_fill_manual (values=c("#0275D2", "#00E699", "#FB008A")) +
theme(legend.position="bottom")
top10Fatalities <- shoot %>% filter(rank(desc(Fatalities)) <= 10)
top10Fatalities <- top10Fatalities[order(-top10Fatalities$Fatalities),]
formattable(top10Fatalities[ c("Location", "Date", "Fatalities", "Injured", "Total.victims", "Mental.Health.Issues")], list(
Fatalities = color_bar("coral"),
Injured = color_bar("springgreen"),
Total.victims = color_bar("violet"),
Mental.Health.Issues = formatter("span", style = x ~ ifelse(x == "Yes", style(color = "red", font.weight = "bold"), NA))))
top10Total.victims <- shoot %>% filter(rank(desc(Total.victims)) <= 10)
top10Total.victims <- top10Total.victims[order(-top10Total.victims$Total.victim),]
formattable(top10Total.victims[ c("Location", "Date", "Fatalities", "Injured", "Total.victims", "Mental.Health.Issues")], list(
Fatalities = color_bar("coral"),
Injured = color_bar("springgreen"),
Total.victims = color_bar("violet"),
Mental.Health.Issues = formatter("span", style = x ~ ifelse(x == "Yes", style(color = "red", font.weight = "bold"), NA))))
ggplot(shoot, aes(x = Race), groupName='Mental.Health.Issues') +
geom_bar(aes(fill = Mental.Health.Issues), width = 0.5) +
labs(title="Number of Shootings with Mental Health Issues per Race") +
theme(axis.text.x=element_text(angle=45)) +
scale_fill_manual (values=c("#0275D2", "#00E699", "#FB008A")) +
theme(legend.position="bottom")
